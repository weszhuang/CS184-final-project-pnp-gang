<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <style>
        body {
            padding: 100px;
            width: 1000px;
            margin: auto;
            text-align: left;
            font-weight: 300;
            font-family: 'Open Sans', sans-serif;
            color: #121212;
        }

        h1,
        h2,
        h3,
        h4 {
            font-family: 'Source Sans Pro', sans-serif;
        }
    </style>
    <title>CS 184/284A Final Project Report</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <link href="https://fonts.googleapis.com/css?family=Open+Sans|Source+Sans+Pro" rel="stylesheet">
</head>


<body>
    <h1 align="middle">CS 184/284A: Computer Graphics and Imaging, Spring 2024</h1>
    <h1 align="middle">Final Project Report</h1>
    <h2 align="middle">Brian Kim, Wesley Zhuang, Yuxiang Jiang, Mark Nguyen</h2>
    <h2>Minecraft Shaders</h2>
    <h2>Abstract</h2>
    <p>
        Minecraft was designed to be a lightweight game and was designed to have very simple textures and lighting. 
        For example, the game does not take advantage of the normal map of each block texture, resulting in a flat texture
        for blocks like cobblestone or furnace. Also, the game treats sunlight as an ambient light, and blocks facing away from the sun
        will have the same brightness as the blocks facing the sun. Our team wanted to enhance lighting and textures in minecraft so scenes look realistic. <br><br>
        We were able to bring in normal shading, where blocks facing away from the sun will look darker than blocks facing the sun. 
        We added shadows, and added realism through the shadows by accounting for shadow distortion and transparent blocks. 
        We have used the normal maps of block textures and parallelex mapping to add depth of field to the textures of blocks. 
        Finally, we used specular highlights to make the reflection of sunlight in certain blocks more shiny and realistic.
    </p>
    <h2>Technical approach</h2>
        <h3>Normal Shading</h3>
        <p>Normal shading uses the normal vector of the surface of a block and the suns direction to calculate the contribution of the sunlight in each block.
        if the surface normal is facing the sun, the sunlight contribution of the block will be close to one. If a block is facing away from the sun (at 90 degrees),
        the sunlight contribution will be zero. </p>
        <div align="middle">
            <table style="width:100%">
               
                <tr align="center">
                    <td>
                        <img src="images/normalshading.png" align="middle" width="500px" />
                    </td>
                </tr>
                <br>
            </table>
        </div>
        <p>
            We added a small bit of ambient light to make sure that blocks which face away from the sun doesn't look completly dark. 
        </p>
        <div align="middle">
            <table style="width:100%">
                <tr align="center">
                    <td>
                        <img src="images/normalshading-1.png" align="middle" width="800px" />
                    </td>
                </tr>
                <br>
            </table>
        </div>
        <p>
            Simply put, we were able to extract the world coordiante, texture coordinate, and the normal of the surface from the vertex shader. 
            In the fragment shader, we can extract the texture of the biome and put the normal vector in the 0~1 range. 
        </p>
        <div align="middle">
            <table style="width:100%">
                <tr align="center">
                    <td>
                        <img src="images/normalshading-2.png" align="middle" width="800px" />
                    </td>
                </tr>
                <br>
            </table>
        </div>
        <p>
            We finally obtain the texture of the sample coordinate and we factor in the sun's contribution (normdotL), into the
            overall light calculation.
        </p>
        <h3>Specular Highlights</h3>
        <h3>Shadows</h3>
        <p>
            To generate shadows, we first take the clip space coordinates that includes the depth texture taken from the eyes point of view, 
            and convert it to clipspace -> view space -> worldspace -> shadowspace. 
        </p>
        <div align="middle">
            <table style="width:100%">
                <tr align="center">
                    <td>
                        <img src="images/shadows-1.png" align="middle" width="800px" />
                    </td>
                </tr>
                <br>
            </table>
        </div>
        <p>
            We use lots of optifine primitives to go from texture to shadowspace. Depth texture from the eye's point of view is given by optifine
            as depth. We then multiply it by the inverse projection matrix and divide by vieW.w to get to viewspace. To get to worldspace we multiply by
            the gbufferModelViewInverse. Using the shadowView and shadowProjection matrix, we can transfer worldspace coordinates to shadow space. 
            We make sure the samplecoords for the shadow stays in the (0, 1) range.
        </p>
        <div align="middle">
            <table style="width:100%">
                <tr align="center">
                    <td>
                        <img src="images/shadows-2.png" align="middle" width="800px" />
                    </td>
                </tr>
                <br>
            </table>
        </div>
        <p>
            Ideally, we want the shadow to be realistic (not black and white). We would ideally like the shadow's color to blend in with the background
            along the edges. To achieve this, we use a tactic similar to supersampling. When we sample shadow texture, we sample in a small box (shadow samples x shadow samples) wide. 
            We then average the colors, giving us a smooth shadow transition.
        </p>
        <div align="middle">
            <table style="width:100%">
                <tr align="center">
                    <td>
                        <img src="images/shadows-3.png" align="middle" width="800px" />
                    </td>
                </tr>
                <br>
            </table>
        </div>
        <p>
            Another factor we take into account is the distance of the shadow in relation to the player. We calculate the centerDistance, 
            which is the distance of the shadow coordinate to the player and distort the position in a way that the shadows get smaller as they get
            further away from the player. 
        </p>
        <div align="middle">
            <table style="width:100%">
                <tr align="center">
                    <td>
                        <img src="images/shadows-4.png" align="middle" width="800px" />
                    </td>
                </tr>
                <br>
            </table>
        </div>
        <p>
            The final consideration for shadows is transparent objects. We want the shadow to be textured differently (combine some colors from the environment)
            if the blocks causing the shadodw are transparent. Optifine gives us shadowtex1, which only includes shadow textures for non-transparent blocks. 
            We can also sample the block color with the texture of the shadow color. We can take a mix of the transmitted color and the original shadow color.
            Realize that shadowVisibility1 will be zero if the object is not transparent. 
        </p>
        <h3>Normal Mapping</h3>
    <h2>Results</h2>
    <h2>References</h2>
    <h2>Contributions from each team member</h2>

</body>

</html>